.clean-progress,
.mountain-progress,
.rocket-progress {
  position: fixed;
  pointer-events: none;
}

.clean-progress[data-progress-placement="top"],
.mountain-progress[data-progress-placement="top"] {
  top: calc(env(safe-area-inset-top) + 6px);
  left: clamp(10px, 2vw, 24px);
  right: clamp(10px, 2vw, 24px);
}

.clean-progress {
  z-index: 92;
  height: 18px;
}

.clean-progress-track,
.clean-progress-fill {
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  border-radius: 999px;
  transform: translateY(-50%);
}

.clean-progress-track {
  height: 8px;
  background: color-mix(in srgb, var(--progress-rail-bg) 88%, transparent);
}

.clean-progress-fill {
  right: auto;
  height: 8px;
  width: calc(var(--reading-progress, 0) * 1%);
  background: var(--progress-fill);
  box-shadow: var(--progress-glow);
}

.clean-progress-marker {
  position: absolute;
  left: clamp(0%, calc(var(--reading-progress, 0) * 1%), 100%);
  top: 50%;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  background: var(--progress-marker-bg);
  box-shadow:
    inset 0 0 0 2px color-mix(in srgb, var(--accent-primary) 36%, transparent),
    var(--progress-marker-shadow);
}

.clean-progress-dark .clean-progress-track {
  backdrop-filter: blur(2px);
}

.clean-progress-light .clean-progress-marker {
  width: 15px;
  height: 15px;
}

.mountain-progress {
  z-index: 96;
  height: 56px;
}

.mountain-progress-runner {
  position: absolute;
  left: clamp(0%, calc(var(--reading-progress, 0) * 1%), 100%);
  top: 50%;
  width: 98px;
  height: 58px;
  transform: translate(-50%, -50%) rotate(-2.5deg);
  transform-origin: 58% 84%;
  transition: transform var(--motion-base) var(--motion-ease-standard);
  filter: drop-shadow(0 8px 12px rgb(0 0 0 / 0.22));
}

.mountain-progress[data-direction="up"] .mountain-progress-runner {
  transform: translate(-50%, -50%) rotate(3deg);
}

.mountain-runner-icon {
  width: 100%;
  height: 100%;
  display: block;
  transform: scaleX(-1);
  animation: runnerStride var(--runner-stride-duration, 0.84s) ease-in-out infinite;
  animation-play-state: paused;
  transform-origin: 58% 84%;
}

.mountain-runner-icon .runner-leg-front,
.mountain-runner-icon .runner-leg-back,
.mountain-runner-icon .runner-leg-front-foot,
.mountain-runner-icon .runner-leg-back-foot {
  transform-box: view-box;
  will-change: transform;
  animation-duration: var(--runner-stride-duration, 0.84s);
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
  animation-fill-mode: both;
  animation-play-state: paused;
}

.mountain-runner-icon .runner-leg-front {
  transform-origin: 72px 79px;
  animation-name: runnerFrontLegSwing;
}

.mountain-runner-icon .runner-leg-back {
  transform-origin: 75px 69px;
  animation-name: runnerBackLegSwing;
}

.mountain-runner-icon .runner-leg-front-foot {
  transform-origin: 45px 113px;
  animation-name: runnerFrontFootStrike;
}

.mountain-runner-icon .runner-leg-back-foot {
  transform-origin: 98px 83px;
  animation-name: runnerBackFootStrike;
}

.mountain-progress[data-running="true"] .mountain-runner-icon,
.mountain-progress[data-running="true"] .mountain-runner-icon .runner-leg-front,
.mountain-progress[data-running="true"] .mountain-runner-icon .runner-leg-back,
.mountain-progress[data-running="true"] .mountain-runner-icon .runner-leg-front-foot,
.mountain-progress[data-running="true"] .mountain-runner-icon .runner-leg-back-foot {
  animation-play-state: running;
}

.runner-ground {
  fill: color-mix(in srgb, var(--surface-2) 72%, transparent);
  opacity: 0.9;
}

.runner-grass {
  fill: none;
  stroke: color-mix(in srgb, var(--text-primary) 44%, var(--surface-2));
  stroke-width: 2.4;
  stroke-linecap: round;
  opacity: 0.8;
}

.runner-silhouette {
  fill: color-mix(in srgb, var(--text-primary) 95%, #010101);
}

.runner-backpack {
  fill: color-mix(in srgb, var(--text-primary) 90%, var(--surface-1));
}

.runner-dust {
  fill: color-mix(in srgb, var(--surface-2) 78%, var(--text-secondary));
  opacity: 0.78;
}

.rocket-progress[data-progress-placement="right"] {
  top: calc(env(safe-area-inset-top) + 8px);
  right: clamp(4px, 1vw, 10px);
  width: 104px;
  height: calc(100vh - env(safe-area-inset-top) - 16px);
  z-index: 120;
}

.rocket-progress .moon {
  position: absolute;
  width: 58px;
  height: 58px;
  right: 20px;
  top: 6px;
  filter: drop-shadow(0 0 10px rgba(255, 210, 138, 0.28));
}

.moon-disc {
  fill: #f3d587;
}

.moon-crater {
  fill: #d8b263;
  opacity: 0.72;
}

.rocket-orbit {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 92px;
  transition: width var(--motion-slow) var(--motion-ease-enter);
}

.rocket-orbit .rocket {
  position: absolute;
  top: 50%;
  right: 12px;
  width: 52px;
  transform: translateY(-50%) rotate(7deg);
  filter: drop-shadow(0 8px 12px rgb(27 42 73 / 0.24));
}

.rocket-orbit .rocket svg {
  display: block;
  width: 100%;
  height: auto;
}

.rocket-body {
  fill: color-mix(in srgb, var(--progress-marker-bg) 88%, white);
  stroke: color-mix(in srgb, var(--text-primary) 68%, #111827);
  stroke-width: 2.6;
}

.rocket-fin {
  fill: color-mix(in srgb, var(--accent-secondary) 82%, #ff9f68);
  stroke: color-mix(in srgb, var(--text-primary) 62%, #111827);
  stroke-width: 2.6;
}

.rocket-stripe {
  fill: color-mix(in srgb, var(--accent-primary) 76%, #ca78ff);
}

.rocket-window-ring {
  fill: color-mix(in srgb, var(--text-primary) 88%, #0f172a);
}

.rocket-window-core {
  fill: color-mix(in srgb, #8fd8ff 82%, white);
}

.rocket-nozzle {
  fill: color-mix(in srgb, var(--accent-secondary) 88%, #ff8f5e);
}

.rocket-trail {
  position: absolute;
  left: 50%;
  top: 84%;
  width: 7px;
  height: 58px;
  transform: translateX(-50%);
  background: linear-gradient(to bottom, rgba(255, 159, 104, 0.88), rgba(255, 159, 104, 0));
  filter: blur(1px);
}

.rocket-orbit.active {
  top: 8px;
  bottom: auto;
  right: 8px;
  width: 90px;
  height: 90px;
  transform-origin: 42px 42px;
  animation: orbitSpin 9.4s linear infinite;
}

.rocket-orbit.active .rocket {
  top: 50%;
  right: -2px;
  transform: translateY(-50%) rotate(14deg);
}

.rocket-orbit.active .rocket-trail {
  height: 34px;
  opacity: 0.58;
}
